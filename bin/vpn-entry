#!/usr/bin/env ash

# ENV VPN_TYPE=openvpn \

# bin_test="`dirname $0`/"

if [[ "$VPN_TYPE" == "openvpn" ]]; then
    echo "starting openvpn..."
    exec ${bin_test}vpn-entry-ov # openvpn
    # echo "success" && exit 0
elif [[ "$VPN_TYPE" == "wireguard" ]]; then
    echo "starting wireguard..."
    exec ${bin_test}/vpn-entry-wg # wireguard
    # echo "success" && exit 0
elif [[ $VPN_TYPE == *-* ]]; then
    # [provider]-[openvpn|wireguard]
    provider=${VPN_TYPE%-*}
    echo "provider: $provider"
    if [ -d "/vpn/$provider" ]; then
        exec ash /vpn/$provider/entry
    fi
fi

echo "unknown vpn: $VPN_TYPE"
sleep 5 # 防止循环重启， 无法查看日志

# VPN_TYPE=surfshark-openvpn ash ./bin/vpn-entry
